CREATE TABLE #Temp(CEST VARCHAR(100),Item VARCHAR(10),NCM VARCHAR(100), Grupo varchar(10))
--drop table #Temp

insert into #Temp values ('0100100','1','38151210','0');
insert into #Temp values ('0100100','1','38151290','0');
insert into #Temp values ('0100200','2','3917','1');
insert into #Temp values ('0100300','3','39181000','0')
insert into #Temp values ('0100400','4','39233000','0')
insert into #Temp values ('0100500','5','39263000','0')
insert into #Temp values ('0100600','6','40103','1')
insert into #Temp values ('0100600','6','59100000','0')
insert into #Temp values ('0100700','7','40169300','0')
insert into #Temp values ('0100700','7','4823909','0')
insert into #Temp values ('0100800','8','40161010','0')
insert into #Temp values ('0100900','9','40169990','0')
insert into #Temp values ('0100900','9','57050000','0')
insert into #Temp values ('0101000','10','59039000','0')
insert into #Temp values ('0101100','11','59090000','0')
insert into #Temp values ('0101200','12','63061','1')
insert into #Temp values ('0101300','13','65061000','0')
insert into #Temp values ('0101400','14','6813','1')
insert into #Temp values ('0101500','15','70071100','0')
insert into #Temp values ('0101500','15','70072100','0')
insert into #Temp values ('0101600','16','70091000','0')
insert into #Temp values ('0101700','17','70140000','0')
insert into #Temp values ('0101800','18','73110000','0')
insert into #Temp values ('0101900','19','73110000','0')
insert into #Temp values ('0102000','20','7320','1')
insert into #Temp values ('0102100','21','7325','1')
insert into #Temp values ('0102200','22','7806','1')
insert into #Temp values ('0102300','23','80070090','0')
insert into #Temp values ('0102400','24','83012','1')
insert into #Temp values ('0102400','24','83016','1')
insert into #Temp values ('0102500','25','83017','1')
insert into #Temp values ('0102600','26','83021000','0')
insert into #Temp values ('0102600','26','83023000','0')
insert into #Temp values ('0102700','27','8310','1')
insert into #Temp values ('0102800','28','84073','1')
insert into #Temp values ('0102900','29','84082','1')
insert into #Temp values ('0103000','30','84099','1')
insert into #Temp values ('0103100','31','84122','1')
insert into #Temp values ('0103200','32','84133','1')
insert into #Temp values ('0103300','33','84141000','0')
insert into #Temp values ('0103400','34','8414801','1')
insert into #Temp values ('0103400','34','8414802','1')
insert into #Temp values ('0103500','35','84139190','0')
insert into #Temp values ('0103500','35','84149010','0')
insert into #Temp values ('0103500','35','8414903','1')
insert into #Temp values ('0103500','35','84149039','0')
insert into #Temp values ('0103600','36','84152','1')
insert into #Temp values ('0103700','37','84212300','0')
insert into #Temp values ('0103800','38','84212990','0')
insert into #Temp values ('0103900','39','84219','1')
insert into #Temp values ('0104000','40','84241000','0')
insert into #Temp values ('0104100','41','84213100','0')
insert into #Temp values ('0104200','42','84213920','0')
insert into #Temp values ('0104300','43','84254200','0')
insert into #Temp values ('0104400','44','84311010','0')
insert into #Temp values ('0104500','45','8431492','1')
insert into #Temp values ('0104500','45','84339090','0')
insert into #Temp values ('0104600','46','84811000','0')
insert into #Temp values ('0104700','47','84812','1')
insert into #Temp values ('0104800','48','84818092','0')
insert into #Temp values ('0104900','49','8482','1')
insert into #Temp values ('0105000','50','8483','1')
insert into #Temp values ('0105100','51','8484','1')
insert into #Temp values ('0105200','52','85052','1')
insert into #Temp values ('0105300','53','85071','1')
insert into #Temp values ('0105400','54','8511','1')
insert into #Temp values ('0105500','55','85122','1')
insert into #Temp values ('0105500','55','85124','1')
insert into #Temp values ('0105500','55','85129000','0')
insert into #Temp values ('0105600','56','85171213','0')
insert into #Temp values ('0105700','57','8518','1')
insert into #Temp values ('0105800','58','85185000','0')
insert into #Temp values ('0105900','59','851981','1')
insert into #Temp values ('0106000','60','8525501','1')
insert into #Temp values ('0106000','60','85256010','0')
insert into #Temp values ('0106100','61','85272','1')
insert into #Temp values ('0106200','62','85272190','0')
insert into #Temp values ('0106200','62','85219090','0')
insert into #Temp values ('0106300','63','85291090','0')
insert into #Temp values ('0106400','64','85340000','0')
insert into #Temp values ('0106500','65','85353','1')
insert into #Temp values ('0106500','65','85365','1')
insert into #Temp values ('0106600','66','85361000','0')
insert into #Temp values ('0106700','67','85362000','0')
insert into #Temp values ('0106800','68','85364','1')
insert into #Temp values ('0106900','69','8538','1')
insert into #Temp values ('0107000','70','85391','1')
insert into #Temp values ('0107100','71','85392','1')
insert into #Temp values ('0107200','72','85442000','0')
insert into #Temp values ('0107300','73','85443000','0')
insert into #Temp values ('0107400','74','8707','1')
insert into #Temp values ('0107500','75','8708','1')
insert into #Temp values ('0107600','76','87141','1')
insert into #Temp values ('0107700','77','87169090','0')
insert into #Temp values ('0107800','78','90261','1')
insert into #Temp values ('0107900','79','90262','1')
insert into #Temp values ('0108000','80','9029','1')
insert into #Temp values ('0108100','81','90303321','0')
insert into #Temp values ('0108200','82','90318040','0')
insert into #Temp values ('0108300','83','9032892','1')
insert into #Temp values ('0108400','84','91040000','0')
insert into #Temp values ('0108500','85','94012000','0')
insert into #Temp values ('0108500','85','94019090','0')
insert into #Temp values ('0108600','86','96138000','0')
insert into #Temp values ('0108700','87','4009','1')
insert into #Temp values ('0108800','88','45049000','0')
insert into #Temp values ('0108800','88','68129910','0')
insert into #Temp values ('0108900','89','48234000','0')
insert into #Temp values ('0109000','90','39191000','0')
insert into #Temp values ('0109000','90','39199000','0')
insert into #Temp values ('0109000','90','87082999','0')
insert into #Temp values ('0109100','91','84123110','0')
insert into #Temp values ('0109200','92','84131900','0')
insert into #Temp values ('0109200','92','84135090','0')
insert into #Temp values ('0109200','92','84138100','0')
insert into #Temp values ('0109300','93','84136019','0')
insert into #Temp values ('0109300','93','84137010','0')
insert into #Temp values ('0109400','94','84145910','0')
insert into #Temp values ('0109400','94','84145990','0')
insert into #Temp values ('0109500','95','84213990','0')
insert into #Temp values ('0109600','96','85011019','0')
insert into #Temp values ('0109700','97','85013110','0')
insert into #Temp values ('0109800','98','85045000','0')
insert into #Temp values ('0109900','99','85072','1')
insert into #Temp values ('0109900','99','85073','1')
insert into #Temp values ('0110000','100','85123000','0')
insert into #Temp values ('0110100','101','9032898','1')
insert into #Temp values ('0110100','101','9032899','1')
insert into #Temp values ('0110200','102','90271000','0')
insert into #Temp values ('0110300','103','40081100','0')
insert into #Temp values ('0110400','104','56012219','0')
insert into #Temp values ('0110500','105','57032000','0')
insert into #Temp values ('0110600','106','57033000','0')
insert into #Temp values ('0110700','107','59119000','0')
insert into #Temp values ('0110800','108','69039099','0')
insert into #Temp values ('0110900','109','70072900','0')
insert into #Temp values ('0111000','110','73145000','0')
insert into #Temp values ('0111100','111','73151100','0')
insert into #Temp values ('0111200','112','73151210','0')
insert into #Temp values ('0111300','113','84189900','0')
insert into #Temp values ('0111400','114','84195','1')
insert into #Temp values ('0111500','115','84249090','0')
insert into #Temp values ('0111600','116','84254910','0')
insert into #Temp values ('0111700','117','84314100','0')
insert into #Temp values ('0111800','118','85016100','0')
insert into #Temp values ('0111900','119','85311090','0')
insert into #Temp values ('0112000','120','90141000','0')
insert into #Temp values ('0112100','121','90251990','0')
insert into #Temp values ('0112200','122','90259010','0')
insert into #Temp values ('0112300','123','90269','1')
insert into #Temp values ('0112400','124','90321010','0')
insert into #Temp values ('0112500','125','90321090','0')
insert into #Temp values ('0112600','126','90322000','0')
insert into #Temp values ('0112700','127','87169','1')
insert into #Temp values ('0112800','128','73229010','0')
insert into #Temp values ('0112900','129','73229010','0')
									


DECLARE @CEST VARCHAR(7)
	   ,@Item INT
	   ,@NCM VARCHAR(11)
	   ,@Grupo BIT

DECLARE CUR CURSOR FAST_FORWARD FOR
SELECT CAST(REPLACE(ltrim(rtrim(CEST)),'.','') AS VARCHAR(7)) AS CEST
	  ,CAST(REPLACE(ltrim(rtrim(Item)),'.','') AS INT) AS Item 
	  ,CAST(REPLACE(ltrim(rtrim(NCM)),'.','') AS VARCHAR(11))AS NCM 
	  ,CONVERT(BIT,REPLACE(ltrim(rtrim(Grupo)),'.','')) AS Grupo 
FROM #Temp

OPEN CUR

FETCH NEXT FROM CUR
INTO @CEST
	,@Item
	,@NCM
	,@Grupo


WHILE @@FETCH_STATUS = 0
BEGIN

	IF(@Grupo = 0)
	BEGIN
	    		
		UPDATE [dbo].[TabelaNCM]
		SET [CEST] = @CEST
		WHERE [NCM] =  @NCM

	END 
	ELSE IF(@Grupo = 1)
	BEGIN
	    
		UPDATE [dbo].[TabelaNCM]
		SET [CEST] = @CEST
		WHERE [NCM] like  @NCM+'%'

	END;	

FETCH NEXT FROM CUR
INTO @CEST
	,@Item
	,@NCM
	,@Grupo

END
CLOSE CUR;
DEALLOCATE CUR;

DROP TABLE #TEMP;




