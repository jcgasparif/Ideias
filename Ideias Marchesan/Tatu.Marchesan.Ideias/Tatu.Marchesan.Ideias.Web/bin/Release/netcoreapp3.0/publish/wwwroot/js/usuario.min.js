$(document).ready(function(){function r(){var n=$("#tbxUserName").val(),t=$("#tbxEmail").val();$.ajax({url:"/Admin/GetUsuarioList?userName="+n+"&email="+t,type:"GET",success:function(n){$("#lista-usuarios-content").html(n)}})}var n,t,i;$("#lnkUsuarios").addClass("active");$("#modal-excluir-claim").on("show.bs.modal",function(i){n=$(i.relatedTarget).attr("data-id");t=$(i.relatedTarget).attr("data-claimValues")});$("#modal-excluir-usuario").on("show.bs.modal",function(t){n=$(t.relatedTarget).attr("data-id")});$("#modal-adicionar-claim").on("hidden.bs.modal",function(){$("#Type, #Value").val("");n=$("#UserId").val()});$("#modal-adicionar-claim").on("show.bs.modal",function(){$("#cbxRole").val("");$("#cbxClaimRole option").remove();$("#Type").val($("#cbxRole option:selected").text().toString())});$("#modal-adicionar-role").on("show.bs.modal",function(){$("#cbxAddRole").val("")});$("#modal-excluir-role").on("show.bs.modal",function(t){n=$(t.relatedTarget).attr("data-userId");i=$(t.relatedTarget).attr("data-roleName")});$("#btnAdicionarClaim").on("click",function(n){n.preventDefault();var t=document.forms[2];if(t.elements.Type.value===""){t.elements.cbxRole.focus();return}if(t.elements.Value.value===""){t.elements.cbxClaimRole.focus();return}$.ajax({url:"/Admin/AdicionarClaim",data:new FormData(t),contentType:!1,processData:!1,type:"POST",success:function(n){n.success?($("#modal-adicionar-claim").modal("hide"),$("#lista-claim-content").load(n.url)):$("#modal-adicionar-claim").modal("hide")},fail:function(){alert("Falha ao adicionar a permissão.")}})});$("#btnAdicionarRole").on("click",function(n){n.preventDefault();var t=document.forms[3];$.ajax({url:"/Admin/AdicionarRoleUsuario",data:new FormData(t),contentType:!1,processData:!1,type:"POST",success:function(n){n.success?($("#modal-adicionar-role").modal("hide"),$("#lista-role-content").load(n.url)):$("#modal-adicionar-role").modal("hide")},fail:function(){alert("Falha ao adicionar a role.")}})});$("#btnExcluirUsuario").click(function(t){t.preventDefault();$.ajax({url:"/Admin/Delete?id="+n,type:"GET",success:function(){document.location.reload()}})});$("#btnExcluirClaim").click(function(i){i.preventDefault();$.ajax({url:"/Admin/ExcluirClaim?userId="+n+"&claimValues="+t,type:"GET",success:function(n){n.success?($("#modal-excluir-claim").modal("hide"),$("#lista-claim-content").load(n.url)):($("#modal-excluir-claim").html(n),$("#modal-excluir-claim").find(".modal").modal("show"))},fail:function(){alert("Falha ao excluir a permissão.")}})});$("#btnExcluirRole").click(function(t){t.preventDefault();$.ajax({url:"/Admin/ExcluirRoleUser?userId="+n+"&roleName="+i,type:"GET",success:function(n){n.success?($("#modal-excluir-role").modal("hide"),$("#lista-role-content").load(n.url)):($("#modal-excluir-role").html(n),$("#modal-excluir-role").find(".modal").modal("show"))},fail:function(){alert("Falha ao excluir a role.")}})});$("#tbxUserName, #tbxEmail").change(function(){r()});$("#tbxUserName, #tbxEmail").keyup(function(){r()});$("#cbxRole").change(function(){$("#Type").val($("#cbxRole option:selected").text().toString());var n=$("#UserId").val();$.ajax({url:"/Admin/GetClaimValueByRoleName",data:{roleName:$("#cbxRole option:selected").val(),userId:n},type:"GET"}).done(function(n){var t=$("#cbxClaimRole");t.empty();$.each(n,function(n,i){t.append($("<option>",{value:i.id}).text(i.claimValue))})}).fail(function(){})});$("#cbxClaimRole").change(function(){var n=$("#cbxClaimRole option:selected").map(function(){return $(this).text()}).get().join(",");$("#Value").val(n)})});